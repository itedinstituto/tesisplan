<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TesisPlan PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo para la barra de desplazamiento (opcional, para mejorar estética) */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .sidebar-item.active {
            background-color: #4A5568; /* gray-700 */
            color: white;
        }
        .sidebar-item:hover {
            background-color: #2D3748; /* gray-800 */
        }
        #sidebar {
            display: flex;
            flex-direction: column;
        }
        #menuNav {
            flex-grow: 1;
        }
        .tab-button {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: #4b5563; /* text-gray-600 */
        }
        .tab-button:hover {
            border-bottom-color: #9ca3af; /* gray-400 */
            color: #1f2937; /* text-gray-800 */
        }
        .tab-button.active {
            border-bottom-color: #0ea5e9; /* sky-500 */
            color: #0284c7; /* sky-600 */
            font-weight: 600;
        }
        .input-error {
            border-color: #ef4444; /* red-500 */
        }
        .error-message {
            color: #ef4444; /* red-500 */
            font-size: 0.875rem; /* text-sm */
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">
    <div class="flex flex-col md:flex-row h-screen">
        <aside id="sidebar" class="w-full md:w-72 bg-slate-800 text-slate-100 p-4 md:p-6 space-y-2 shadow-lg">
            <div>
                <h1 class="text-2xl md:text-3xl font-bold text-center text-sky-400">
                    TesisPlan <span class="text-sky-300">PRO</span>
                </h1>
                <p class="text-sm text-center text-slate-400 mb-6">Asistente de IA para Tesis</p>
            </div>
            <nav id="menuNav" class="space-y-1">
                </nav>
            <div class="mt-auto pt-4 border-t border-slate-700">
                <p class="text-xs text-slate-500 text-center">
                    Derechos reservados para Dr. Gerardo Ch. Chinguel - Instituto de Tecnologías para la Educación (ITED)
                </p>
            </div>
        </aside>

        <main id="mainContent" class="flex-1 p-4 md:p-8 overflow-y-auto">
            <div id="content-area" class="bg-white p-6 rounded-xl shadow-xl">
                <div class="text-center py-10" id="welcomeMessage">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16 mx-auto text-sky-500 mb-4">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25V14.25m-3.75-3.75H10.5m1.5 0H15m-4.5 0V9m0 3.75v3.75m0-3.75h-3m5.25 0h3" />
                    </svg>
                    <h2 class="text-3xl font-semibold text-slate-700">Bienvenido a TesisPlan PRO</h2>
                    <p class="text-slate-500 mt-3 text-lg">Selecciona una sección del menú de la izquierda para comenzar a generar prompts útiles para tu tesis.</p>
                    <p class="text-sm text-slate-400 mt-8">Consejo: Puedes ingresar el título de tu tesis (opcional) para que los prompts sean más personalizados.</p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Almacenamiento global para los datos del Proyecto de Tesis
        let proyectoTesisData = {
            nivelAcademico: '',
            enfoqueInvestigacion: '',
            disenoInvestigacion: '',
            formulacionProblema: '',
            objetivoGeneral: '',
            objetivosEspecificos: '',
            variableIndependiente: '', // Nueva
            variableDependiente: ''    // Nueva
        };

        const menuItems = [
            {
                id: 'matriz_consistencia',
                title: 'Matriz de consistencia',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"> <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" /> </svg>`,
                hasTabs: true, 
                tabs: [ 
                    { id: 'delimitar', title: 'Delimitar' },
                    { id: 'problema', title: 'Problema' },
                    { id: 'objetivos', title: 'Objetivos' },
                    { id: 'hipotesis', title: 'Hipótesis' },
                    { id: 'matriz_completa', title: 'Matriz' },
                    { id: 'titulos_propuestos', title: 'Títulos' }
                ]
            },
            {
                id: 'matriz_operacionalizacion',
                title: 'Matriz de operacionalización',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.646.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.333.183-.582.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.019-.398-1.11-.94L9.21 17.49c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>`,
            },
            {
                id: 'proyecto_tesis',
                title: 'Proyecto de Tesis',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>`,
            },
            {
                id: 'planteamiento_investigacion',
                title: 'Planteamiento de investigación',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607zM10.5 7.5v6m3-3h-6" /></svg>`,
                hasTabs: true,
                tabs: [
                    { id: 'estructura_pi', title: 'Estructura' }, 
                    { id: 'realidad_pi', title: 'Realidad' },
                    { id: 'delimitacion_pi', title: 'Delimitación' },
                    { id: 'justificacion_pi', title: 'Justificación' }
                ]
            },
            {
                id: 'marco_teorico',
                title: 'Marco teórico',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>`,
                hasTabs: true, 
                tabs: [ 
                    { id: 'antecedentes_estudio', title: 'Antecedentes de estudio' },
                    { id: 'bases_teoricas', title: 'Bases teóricas' }
                ]
            },
            {
                id: 'metodologia',
                title: 'Metodología',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h7.5M8.25 12h7.5m-7.5 5.25h7.5M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 17.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg>`,
                promptGenerator: (tesisTitle = "[Título de tu Tesis]") => `Actúa como un consultor metodológico. Para mi tesis "${tesisTitle}", necesito definir con precisión la Metodología de Investigación. Genera un prompt que me guíe para detallar: 1. Enfoque de la investigación (cuantitativo, cualitativo o mixto). 2. Tipo de investigación (exploratoria, descriptiva, correlacional, explicativa, experimental, etc.). 3. Diseño de la investigación (experimental, no experimental, transversal, longitudinal, etc.). 4. Población y Muestra: Descripción de la población objetivo, criterios de inclusión/exclusión, tipo de muestreo y cálculo del tamaño muestral (si aplica). 5. Técnicas e Instrumentos de Recolección de Datos: Descripción de las técnicas (encuesta, entrevista, observación, etc.) y los instrumentos (cuestionario, guía de entrevista, ficha de observación, etc.), incluyendo su proceso de validación y confiabilidad. 6. Procedimiento de recolección de datos. 7. Plan de Análisis de Datos: Descripción de las técnicas estadísticas o de análisis cualitativo que se utilizarán. El prompt debe ser específico y ayudarme a tomar decisiones metodológicas fundamentadas.`
            },
            {
                id: 'cronograma_presupuesto',
                title: 'Cronograma y Presupuesto',
                icon: `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-3"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0H5.25m13.5 0H18.75m0 0A2.25 2.25 0 0016.5 21H7.5A2.25 2.25 0 005.25 18.75M12 12.75h.008v.008H12v-.008z" /></svg>`,
                promptGenerator: (tesisTitle = "[Título de tu Tesis]") => `Actúa como un gestor de proyectos de investigación. Necesito elaborar el Cronograma y Presupuesto para mi tesis "${tesisTitle}". Genera un prompt que me ayude a: A. Para el Cronograma (usualmente un diagrama de Gantt): 1. Listar todas las actividades principales y secundarias del proceso de tesis (desde la planificación hasta la sustentación). 2. Estimar la duración de cada actividad. 3. Establecer las dependencias entre actividades. 4. Definir responsables (si aplica). 5. Visualizar el cronograma en semanas o meses. B. Para el Presupuesto: 1. Identificar todos los posibles rubros de gasto: personal (si aplica), materiales y equipos, viajes y viáticos, servicios de terceros (impresiones, análisis estadístico, etc.), bibliografía, imprevistos. 2. Estimar el costo unitario y total para cada rubro. 3. Identificar posibles fuentes de financiamiento. El prompt debe ser práctico y ayudarme a planificar realistamente los recursos y tiempos.`
            }
        ];

        const menuNavElement = document.getElementById('menuNav'); 
        const mainContentArea = document.getElementById('content-area');
        const welcomeMessageElement = document.getElementById('welcomeMessage'); 
        let currentActiveItemId = null;
        let currentActiveTabId = null;
        
        function renderRegularContent(item) {
            welcomeMessageElement.style.display = 'none';
            if (item.id === 'matriz_operacionalizacion') {
                mainContentArea.innerHTML = `
                    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-slate-700">Genera la Matriz de operacionalización de variables.</h2>
                    <p class="text-sm text-slate-600 mb-6">La matriz de operacionalización es una herramienta que organiza las variables del estudio, especificando cómo se medirán y analizarán. Es esencial en el proyecto de tesis porque facilita la conexión entre los objetivos, preguntas de investigación e hipótesis, garantizando claridad y coherencia en el desarrollo del marco teórico y el proceso de recolección de datos.</p>
                    
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="opNivelAcademico" class="block text-sm font-medium text-slate-700 mb-1">Nivel Académico:</label>
                            <select id="opNivelAcademico" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="pregrado">Pregrado</option>
                                <option value="maestria">Maestría</option>
                                <option value="doctorado">Doctorado</option>
                            </select>
                            <p id="errorOpNivelAcademico" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="opEnfoqueInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Enfoque de investigación:</label>
                            <select id="opEnfoqueInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="cuantitativo">Cuantitativo</option>
                                <option value="cualitativo">Cualitativo</option>
                                <option value="mixto">Mixto</option>
                            </select>
                            <p id="errorOpEnfoqueInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="opDisenoInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Diseño de investigación:</label>
                            <input type="text" id="opDisenoInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: pre-experimental, descriptivo-propositivo, etc.">
                            <p id="errorOpDisenoInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="opVarIndependiente" class="block text-sm font-medium text-slate-700 mb-1">Variable independiente:</label>
                            <input type="text" id="opVarIndependiente" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Uso de redes sociales">
                            <p id="errorOpVarIndependiente" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="opVarDependiente" class="block text-sm font-medium text-slate-700 mb-1">Variable dependiente:</label>
                            <input type="text" id="opVarDependiente" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Rendimiento académico">
                            <p id="errorOpVarDependiente" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Rango de años:</label>
                            <div class="flex space-x-2">
                                <input type="number" id="opRangoAnioInicio" class="w-1/2 p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="2019">
                                <input type="number" id="opRangoAnioFin" class="w-1/2 p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="2024">
                            </div>
                             <p id="errorOpRangoAnios" class="error-message mt-1 hidden">Ambos años son obligatorios y el año de inicio no puede ser mayor al de fin.</p>
                        </div>
                        <div>
                            <label for="opFiltroDb" class="block text-sm font-medium text-slate-700 mb-1">Filtro de búsqueda (bases de datos):</label>
                            <textarea id="opFiltroDb" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="2">Latindex o Scielo o Scopus o WOS</textarea>
                            <p id="errorOpFiltroDb" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>

                    <button id="generatePromptPaso8" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 8)
                    </button>

                    <div id="promptsOperacionalizacionContainer" class="hidden space-y-6">
                        <div id="promptPaso8Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Matriz (paso8):</label>
                            <textarea id="prompt8" class="w-full h-40 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso8" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso8)</button>
                            <span id="copyMessagePaso8" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                        <div id="promptPaso9Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Filtrar la definición conceptual por países (paso9):</label>
                            <textarea id="prompt9" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso9" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso9)</button>
                            <span id="copyMessagePaso9" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                        <div id="promptPaso10Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Añadir más columnas a la operacionalización (paso10):</label>
                            <textarea id="prompt10" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso10" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso10)</button>
                            <span id="copyMessagePaso10" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                        <div id="promptPaso11Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generar las referencias bibliográficas de la Matriz (paso11):</label>
                            <textarea id="prompt11" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso11" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso11)</button>
                            <span id="copyMessagePaso11" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                    </div>
                `;
                setupMatrizOperacionalizacion();
            } else if (item.id === 'proyecto_tesis') {
                mainContentArea.innerHTML = `
                    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-slate-700">Establece los parámetros de tu proyecto de tesis</h2>
                    <p class="text-sm text-slate-600 mb-6">Completa las casillas para generar los prompts que te ayudarán a completar las secciones del proyecto de tesis. Esta información debes extraerla de la Matriz de Consistencia que has validado.</p>
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="ptNivelAcademico" class="block text-sm font-medium text-slate-700 mb-1">Nivel Académico:</label>
                            <select id="ptNivelAcademico" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="pregrado">Pregrado</option>
                                <option value="maestria">Maestría</option>
                                <option value="doctorado">Doctorado</option>
                            </select>
                            <p id="errorPtNivelAcademico" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ptEnfoqueInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Enfoque de investigación:</label>
                            <select id="ptEnfoqueInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="cuantitativo">Cuantitativo</option>
                                <option value="cualitativo">Cualitativo</option>
                                <option value="mixto">Mixto</option>
                            </select>
                            <p id="errorPtEnfoqueInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ptDisenoInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Diseño de investigación:</label>
                            <input type="text" id="ptDisenoInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: pre-experimental, descriptivo-propositivo, etc.">
                            <p id="errorPtDisenoInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                         <div>
                            <label for="ptVarIndependiente" class="block text-sm font-medium text-slate-700 mb-1">Variable independiente:</label>
                            <input type="text" id="ptVarIndependiente" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Uso de TikTok">
                            <p id="errorPtVarIndependiente" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ptVarDependiente" class="block text-sm font-medium text-slate-700 mb-1">Variable dependiente:</label>
                            <input type="text" id="ptVarDependiente" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Rendimiento académico">
                            <p id="errorPtVarDependiente" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ptFormulacionProblema" class="block text-sm font-medium text-slate-700 mb-1">Formulación del problema:</label>
                            <textarea id="ptFormulacionProblema" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="3" placeholder="Pega aquí la formulación del problema."></textarea>
                            <p id="errorPtFormulacionProblema" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ptObjetivoGeneral" class="block text-sm font-medium text-slate-700 mb-1">Objetivo general:</label>
                            <textarea id="ptObjetivoGeneral" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="2" placeholder="Pega aquí el objetivo general."></textarea>
                            <p id="errorPtObjetivoGeneral" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ptObjetivosEspecificos" class="block text-sm font-medium text-slate-700 mb-1">Objetivos específicos (uno por línea):</label>
                            <textarea id="ptObjetivosEspecificos" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="4" placeholder="Pega aquí los objetivos específicos."></textarea>
                            <p id="errorPtObjetivosEspecificos" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="configurarProyectoBtn" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" />
                        </svg>
                        Generar prompt (paso 11) 
                    </button>
                    <div id="proyectoConfiguradoMessage" class="hidden mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
                        El proyecto de Tesis ha sido configurado. Ahora ya puedes copiar los prompts para completar las secciones del Proyecto.
                    </div>
                `;
                setupProyectoTesis();
            }
             else { 
                 mainContentArea.innerHTML = `
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-slate-700">${item.title}</h2>
                    <div class="mb-6">
                        <label for="tesisTitleInputRegular" class="block text-sm font-medium text-slate-600 mb-1">
                            Título de tu Tesis (opcional):
                        </label>
                        <input type="text" id="tesisTitleInputRegular" class="w-full p-3 border border-slate-300 rounded-lg shadow-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition duration-150" placeholder="Ej: Impacto de las redes sociales en el rendimiento académico">
                    </div>
                    <button id="generatePromptButtonRegular" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar Prompt para ${item.title}
                    </button>
                    <div id="promptOutputContainerRegular" class="mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <p class="text-sm text-slate-500 italic mb-2">El prompt generado aparecerá aquí abajo.</p>
                        <textarea id="promptOutputRegular" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly placeholder="Aquí aparecerá el prompt generado..."></textarea>
                        <button id="copyPromptButtonRegular" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar Prompt
                        </button>
                        <span id="copyMessageRegular" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                    </div>
                `;
                if (typeof item.promptGenerator === 'function') {
                    setupPromptGeneration(item, 'tesisTitleInputRegular', 'generatePromptButtonRegular', 'promptOutputRegular', 'copyPromptButtonRegular', 'copyMessageRegular');
                }
            }
        }


        function renderTabbedContent(item) {
            welcomeMessageElement.style.display = 'none';
            currentActiveTabId = item.tabs[0].id; 

            mainContentArea.innerHTML = `
                <h2 class="text-2xl md:text-3xl font-bold mb-4 text-slate-700">${item.title}</h2>
                <div id="tabButtonsContainer" class="flex border-b border-slate-300 mb-6 flex-wrap"></div>
                <div id="tabContentContainer"></div>
            `;
            
            const tabButtonsContainer = document.getElementById('tabButtonsContainer');
            item.tabs.forEach(tabInfo => {
                const tabButton = document.createElement('button');
                tabButton.id = `tab-btn-${tabInfo.id}`;
                tabButton.className = 'tab-button'; 
                tabButton.textContent = tabInfo.title;
                if (tabInfo.id === currentActiveTabId) {
                    tabButton.classList.add('active'); 
                }
                tabButton.addEventListener('click', () => {
                    if (currentActiveTabId) {
                        document.getElementById(`tab-btn-${currentActiveTabId}`)?.classList.remove('active');
                    }
                    tabButton.classList.add('active');
                    currentActiveTabId = tabInfo.id;
                    renderSingleTabContent(tabInfo, item.id); 
                });
                tabButtonsContainer.appendChild(tabButton);
            });
            renderSingleTabContent(item.tabs.find(t => t.id === currentActiveTabId), item.id); 
        }

        function renderSingleTabContent(tabInfo, menuItemId) {
            const tabContentContainer = document.getElementById('tabContentContainer');
            if (!tabContentContainer) { 
                console.error("Tab content container not found!");
                return;
            }

            tabContentContainer.innerHTML = ''; 

            if (menuItemId === 'matriz_consistencia' && tabInfo.id === 'delimitar') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">Paso 1: Delimitar una idea de investigación e identificar el problema a investigar.</h3>
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="nivelAcademico" class="block text-sm font-medium text-slate-700 mb-1">Nivel Académico:</label>
                            <select id="nivelAcademico" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="pregrado">Pregrado</option>
                                <option value="maestria">Maestría</option>
                                <option value="doctorado">Doctorado</option>
                            </select>
                            <p id="errorNivelAcademico" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="ideaInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Idea de investigación o problema:</label>
                            <input type="text" id="ideaInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Escribe tu idea de investigación">
                            <p id="errorIdeaInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="enfoqueInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Enfoque de investigación:</label>
                            <select id="enfoqueInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="cuantitativo">Cuantitativo</option>
                                <option value="cualitativo">Cualitativo</option>
                                <option value="mixto">Mixto</option>
                            </select>
                            <p id="errorEnfoqueInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="disenoInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Diseño de investigación:</label>
                            <input type="text" id="disenoInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: pre-experimental, descriptivo-propositivo, etc.">
                            <p id="errorDisenoInvestigacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso1" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 1)
                    </button>
                    <div id="promptPaso1Container" class="hidden mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generado (paso1):</label>
                        <textarea id="prompt1" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                        <button id="copyPromptPaso1" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar prompt (paso1)
                        </button>
                        <span id="copyMessagePaso1" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                    </div>
                `;
                setupDelimitarTab();
            } else if (menuItemId === 'matriz_consistencia' && tabInfo.id === 'problema') {
                 tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">Paso 2: Formular el problema de investigación</h3>
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="problemaTemaDelimitado" class="block text-sm font-medium text-slate-700 mb-1">Tema delimitado que hayas elegido en el prompt anterior:</label>
                            <input type="text" id="problemaTemaDelimitado" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Efecto del tiempo de uso de TikTok en el rendimiento académico...">
                            <p id="errorProblemaTemaDelimitado" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="problemaDonde" class="block text-sm font-medium text-slate-700 mb-1">¿Dónde haz identificado el problema de investigación?</label>
                            <input type="text" id="problemaDonde" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: universidad privada en Lima">
                            <p id="errorProblemaDonde" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="problemaAQuien" class="block text-sm font-medium text-slate-700 mb-1">¿A quién vas a realizar el estudio?</label>
                            <input type="text" id="problemaAQuien" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: estudiantes de la carrera de Ciencias de la Comunicación">
                            <p id="errorProblemaAQuien" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="problemaPeriodo" class="block text-sm font-medium text-slate-700 mb-1">¿Cuál es el periódo donde analizarás el problema?</label>
                            <input type="text" id="problemaPeriodo" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: enero a julio 2025">
                             <p id="errorProblemaPeriodo" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso2" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 2)
                    </button>
                    <div id="promptPaso2Container" class="hidden mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generado (paso2):</label>
                        <textarea id="prompt2" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                        <button id="copyPromptPaso2" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar prompt (paso2)
                        </button>
                         <span id="copyMessagePaso2" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                    </div>
                `;
                setupProblemaTab();
            } else if (menuItemId === 'matriz_consistencia' && tabInfo.id === 'objetivos') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">Paso 3: Formular el objetivo general y específicos</h3>
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="objetivosProblemaInvestigacion" class="block text-sm font-medium text-slate-700 mb-1">Problema de investigación:</label>
                            <textarea id="objetivosProblemaInvestigacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="3" placeholder="Pega aquí el problema de investigación generado en el paso anterior."></textarea>
                            <p id="errorObjetivosProblema" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="cantidadObjetivosEspecificos" class="block text-sm font-medium text-slate-700 mb-1">Cantidad de objetivos específicos:</label>
                            <input type="number" id="cantidadObjetivosEspecificos" value="4" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                            <p id="errorCantidadObjetivos" class="error-message mt-1 hidden">Debe ser un número mayor a 0.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso3" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 3)
                    </button>
                    <div id="promptPaso3Container" class="hidden mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generado (paso3):</label>
                        <textarea id="prompt3" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                        <button id="copyPromptPaso3" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar prompt (paso3)
                        </button>
                         <span id="copyMessagePaso3" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                    </div>
                `;
                setupObjetivosTab();
            } else if (menuItemId === 'matriz_consistencia' && tabInfo.id === 'hipotesis') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">Paso 4: Plantear la hipótesis según el enfoque y diseño de investigación.</h3>
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="hipotesisVarIndependiente" class="block text-sm font-medium text-slate-700 mb-1">Variable independiente:</label>
                            <input type="text" id="hipotesisVarIndependiente" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Tiempo de uso de TikTok">
                            <p id="errorHipotesisVarInd" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="hipotesisVarDependiente" class="block text-sm font-medium text-slate-700 mb-1">Variable dependiente:</label>
                            <input type="text" id="hipotesisVarDependiente" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" placeholder="Ej: Rendimiento académico de los estudiantes">
                            <p id="errorHipotesisVarDep" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso4" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 4)
                    </button>
                    <div id="promptPaso4Container" class="hidden mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generado (paso4):</label>
                        <textarea id="prompt4" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                        <button id="copyPromptPaso4" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar prompt (paso4)
                        </button>
                         <span id="copyMessagePaso4" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                    </div>
                `;
                setupHipotesisTab();
            } else if (menuItemId === 'matriz_consistencia' && tabInfo.id === 'matriz_completa') {
                 tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">Paso 5: Generar la Matriz de Consistencia de la investigación a realizar.</h3>
                    <button id="generatePromptPaso5" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 5)
                    </button>
                    <div id="promptPaso5Container" class="hidden mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generado (paso5):</label>
                        <textarea id="prompt5" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                        <button id="copyPromptPaso5" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar prompt (paso5)
                        </button>
                         <span id="copyMessagePaso5" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>

                        <div class="mt-6 pt-4 border-t border-slate-300">
                            <label class="block text-sm font-semibold text-slate-700 mb-1">Valida la matriz de consistencia con el modelo de IA - Investigación profunda.</label>
                            <p class="text-xs text-slate-500 mb-2">Si necesitas encontrar investigaciones similares a tu matriz de consistencia puedes usar el herramienta Grok o Perplexity con el siguiente prompt. (Recuerda copiar la Matriz a word o pdf para subirla a Grok o Perplexity)</p>
                            <textarea id="prompt6" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                            <button id="copyPromptPaso6" class="mt-3 bg-purple-500 hover:bg-purple-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-purple-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                                Copiar prompt (paso6)
                            </button>
                            <span id="copyMessagePaso6" class="ml-3 text-sm text-purple-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                    </div>
                `;
                setupMatrizCompletaTab();
            } else if (menuItemId === 'matriz_consistencia' && tabInfo.id === 'titulos_propuestos') {
                 tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">Paso 6: Plantear el título tentativo para el proyecto de Tesis.</h3>
                     <button id="generatePromptPaso7" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 7)
                    </button>
                    <div id="promptPaso7Container" class="hidden mt-4 p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                        <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generado (paso7):</label>
                        <textarea id="prompt7" class="w-full h-60 md:h-80 p-3 text-slate-700 bg-white border border-slate-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 resize-y" readonly></textarea>
                        <button id="copyPromptPaso7" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-75 transition duration-150 ease-in-out flex items-center text-sm">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 4.625v2.625m0 0H12m3.75 0l-3.75-3.75M12 17.25v-2.625" /></svg>
                            Copiar prompt (paso7)
                        </button>
                         <span id="copyMessagePaso7" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                    </div>
                `;
                setupTitulosTab();
            } else if (menuItemId === 'planteamiento_investigacion' && tabInfo.id === 'estructura_pi') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-700 mb-3">Planteamiento de investigación</h3>
                    <p class="text-sm text-slate-600 mb-2 leading-relaxed">El planteamiento de investigación de un proyecto de tesis es una sección fundamental que define claramente el problema o la cuestión que se pretende abordar en el estudio. Es el punto de partida que justifica y orienta toda la investigación. Su propósito principal es exponer de manera clara y precisa cuál es el problema que se investigará, su relevancia y el contexto en el que se sitúa.</p>
                    <p class="text-sm text-slate-600 mb-4 leading-relaxed">El esquema de redacción puede ser variante, sin embargo aquí una propuesta:</p>
                    <ul class="list-disc list-inside text-sm text-slate-600 space-y-1 pl-4">
                        <li>Realidad problemática</li>
                        <li>Delimitación del problema</li>
                        <li>Formulación del problema</li>
                        <li>Justificación</li>
                        <li>Objetivos de la investigación.</li>
                    </ul>
                `;
            } else if (menuItemId === 'planteamiento_investigacion' && tabInfo.id === 'realidad_pi') {
                 tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-700 mb-3">Realidad problemática</h3>
                    <p class="text-sm text-slate-600 mb-2 leading-relaxed">Redactar la realidad problemática en una investigación permite contextualizar y delimitar el problema de estudio, identificando las causas, consecuencias y actores involucrados.</p>
                    <p class="text-sm text-slate-600 mb-6 leading-relaxed">La estructura de redacción es: Introducción al problema, contexto internacional, contexto nacional.</p>
                    
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="filtroInternacional" class="block text-sm font-medium text-slate-700 mb-1">Filtro de búsqueda del Contexto Internacional:</label>
                            <textarea id="filtroInternacional" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="3">tres fuentes de información de México, Colombia o Ecuador de los últimos cinco años, provenientes de bases de datos como Latindex, Scielo, Scopus o WOS</textarea>
                            <p id="errorFiltroInternacional" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="filtroNacional" class="block text-sm font-medium text-slate-700 mb-1">Filtro de búsqueda del Contexto Nacional:</label>
                            <textarea id="filtroNacional" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="3">Tres fuentes de información de Perú de los últimos cinco años, provenientes de bases de datos como Latindex, Scielo, Scopus o WOS</textarea>
                            <p id="errorFiltroNacional" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso12" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 12)
                    </button>
                     <div id="promptsRealidadProblematicasContainer" class="hidden space-y-6">
                        <div id="promptPaso12Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Realidad Problemática (paso12):</label>
                            <textarea id="prompt12" class="w-full h-60 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso12" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso12)</button>
                            <span id="copyMessagePaso12" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                        <div id="promptPaso13Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generar las referencias bibliográficas de la Realidad Problemática (paso13):</label>
                            <textarea id="prompt13" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso13" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso13)</button>
                            <span id="copyMessagePaso13" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                    </div>
                `;
                setupRealidadProblemáticaTab();
            } else if (menuItemId === 'planteamiento_investigacion' && tabInfo.id === 'delimitacion_pi') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-700 mb-3">Delimitación del Problema</h3>
                    <p class="text-sm text-slate-600 mb-2 leading-relaxed">La delimitación del problema en una investigación es fundamental para establecer con claridad los límites y el alcance del estudio.</p>
                    <p class="text-sm text-slate-600 mb-6 leading-relaxed">La estructura de redacción es: delimitación espacial, delimitación temporal, delimitación teórica.</p>
                    
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="filtroDelimitacion" class="block text-sm font-medium text-slate-700 mb-1">Filtro de búsqueda (para delimitación teórica):</label>
                            <textarea id="filtroDelimitacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="3">Tres fuentes de información de Perú de los últimos cinco años, provenientes de bases de datos como Latindex, Scielo, Scopus o WOS</textarea>
                            <p id="errorFiltroDelimitacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso14" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 14)
                    </button>
                     <div id="promptsDelimitacionContainer" class="hidden space-y-6">
                        <div id="promptPaso14Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Delimitación del Problema (paso14):</label>
                            <textarea id="prompt14" class="w-full h-60 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso14" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso14)</button>
                            <span id="copyMessagePaso14" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                        <div id="promptPaso15Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generar las referencias bibliográficas de la Delimitación del Problema (paso15):</label>
                            <textarea id="prompt15" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso15" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso15)</button>
                            <span id="copyMessagePaso15" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                    </div>
                `;
                setupDelimitacionProblemaTab();
            } else if (menuItemId === 'planteamiento_investigacion' && tabInfo.id === 'justificacion_pi') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-700 mb-3">Justificación de la investigación</h3>
                    <p class="text-sm text-slate-600 mb-2 leading-relaxed">La justificación de una investigación es esencial para establecer y argumentar la importancia y relevancia del estudio.</p>
                    <p class="text-sm text-slate-600 mb-6 leading-relaxed">La estructura de redacción es: justificación teórica, justificación práctica, justificación académica.</p>
                    
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="filtroJustificacion" class="block text-sm font-medium text-slate-700 mb-1">Filtro de búsqueda (para justificaciones):</label>
                            <textarea id="filtroJustificacion" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="3">tres fuentes de información de Perú de los últimos cinco años, provenientes de bases de datos como Latindex, Scielo, Scopus o WOS</textarea>
                            <p id="errorFiltroJustificacion" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso16" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 16)
                    </button>
                     <div id="promptsJustificacionContainer" class="hidden space-y-6">
                        <div id="promptPaso16Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Justificación de la Investigación (paso16):</label>
                            <textarea id="prompt16" class="w-full h-60 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso16" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso16)</button>
                            <span id="copyMessagePaso16" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                        <div id="promptPaso17Container" class="p-4 bg-slate-50 rounded-lg border border-slate-200 shadow-inner">
                            <label class="block text-sm font-medium text-slate-700 mb-2">Prompt Generar las referencias bibliográficas de la Justificación de la Investigación (paso17):</label>
                            <textarea id="prompt17" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso17" class="mt-3 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso17)</button>
                            <span id="copyMessagePaso17" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                    </div>
                `;
                setupJustificacionTab();
            } else if (menuItemId === 'marco_teorico' && tabInfo.id === 'antecedentes_estudio') {
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-700 mb-3">Antecedentes de estudio</h3>
                    <p class="text-sm text-slate-600 mb-2 leading-relaxed">Redactar los antecedentes de estudio en una tesis permite contextualizar la investigación dentro del conocimiento existente, identificando vacíos y justificando su relevancia.</p>
                    <p class="text-sm text-slate-600 mb-6 leading-relaxed">La estructura de redacción es: antecedentes internacionales, antecedentes nacionales y antecedentes locales.</p>
                    
                    <div class="space-y-4 mb-6">
                        <div>
                            <label for="antecedentesTipoTesis" class="block text-sm font-medium text-slate-700 mb-1">Tipo de tesis:</label>
                            <select id="antecedentesTipoTesis" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500">
                                <option value="">Seleccione...</option>
                                <option value="pregrado">Pregrado</option>
                                <option value="posgrado">Posgrado</option>
                            </select>
                            <p id="errorAntecedentesTipoTesis" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="antecedentesPalabrasClave" class="block text-sm font-medium text-slate-700 mb-1">Palabras clave:</label>
                            <textarea id="antecedentesPalabrasClave" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" rows="2">tiktok, procrastinación, universitarios</textarea>
                            <p id="errorAntecedentesPalabrasClave" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-slate-700 mb-1">Rango de años:</label>
                            <div class="flex space-x-2">
                                <input type="number" id="antecedentesRangoAnioInicio" class="w-1/2 p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="2019">
                                <input type="number" id="antecedentesRangoAnioFin" class="w-1/2 p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="2025">
                            </div>
                            <p id="errorAntecedentesRangoAnios" class="error-message mt-1 hidden">Ambos años son obligatorios y el año de inicio no puede ser mayor al de fin.</p>
                        </div>
                         <div>
                            <label for="antecedentesPaisesInternacional" class="block text-sm font-medium text-slate-700 mb-1">Países de búsqueda a Nivel Internacional:</label>
                            <input type="text" id="antecedentesPaisesInternacional" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="Colombia, Ecuador o México">
                            <p id="errorAntecedentesPaisesInternacional" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                        <div>
                            <label for="antecedentesPaisNacional" class="block text-sm font-medium text-slate-700 mb-1">País de búsqueda a Nivel Nacional:</label>
                            <input type="text" id="antecedentesPaisNacional" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="Perú">
                            <p id="errorAntecedentesPaisNacional" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                         <div>
                            <label for="antecedentesLugarLocal" class="block text-sm font-medium text-slate-700 mb-1">Lugar de búsqueda a Nivel Ciudad o Región:</label>
                            <input type="text" id="antecedentesLugarLocal" class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:ring-sky-500 focus:border-sky-500" value="Departamento de Lima">
                            <p id="errorAntecedentesLugarLocal" class="error-message mt-1 hidden">Este campo es obligatorio.</p>
                        </div>
                    </div>
                    <button id="generatePromptPaso18" class="w-full md:w-auto bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2.5 px-5 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition duration-150 ease-in-out mb-6 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-2"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.624L16.5 21.75l-.398-1.126a3.375 3.375 0 00-2.924-2.924l-1.126-.398 1.126-.398a3.375 3.375 0 002.924-2.924l.398-1.126.398 1.126a3.375 3.375 0 002.924 2.924l1.126.398-1.126.398a3.375 3.375 0 00-2.924 2.924z" /></svg>
                        Generar prompt (paso 18)
                    </button>
                    <div id="promptsAntecedentesContainer" class="hidden space-y-6">
                        <div class="p-4 bg-slate-100 rounded-lg border border-slate-300">
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Paso 1: Ejecuta este prompt para encontrar Antecedentes Internacionales (paso18)</label>
                            <textarea id="prompt18" class="w-full h-32 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso18" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso18)</button>
                            <span id="copyMessagePaso18" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        
                            <label class="block text-sm font-semibold text-slate-700 mb-2 mt-4">Mejora la redacción de los Antecedentes Internacionales (paso19)</label>
                            <textarea id="prompt19" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso19" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso19)</button>
                            <span id="copyMessagePaso19" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>

                            <label class="block text-sm font-semibold text-slate-700 mb-2 mt-4">Genera las referencias de los Antecedentes Internacionales (paso20)</label>
                            <textarea id="prompt20" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso20" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso20)</button>
                            <span id="copyMessagePaso20" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>

                        <div class="p-4 bg-slate-100 rounded-lg border border-slate-300">
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Paso 2: Ejecuta este prompt para encontrar Antecedentes Nacionales (paso21)</label>
                            <textarea id="prompt21" class="w-full h-32 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso21" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso21)</button>
                            <span id="copyMessagePaso21" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        
                            <label class="block text-sm font-semibold text-slate-700 mb-2 mt-4">Mejora la redacción de los Antecedentes Nacionales (paso22)</label>
                            <textarea id="prompt22" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso22" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso22)</button>
                            <span id="copyMessagePaso22" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>

                            <label class="block text-sm font-semibold text-slate-700 mb-2 mt-4">Genera las referencias de los Antecedentes Nacionales (paso23)</label>
                            <textarea id="prompt23" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso23" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso23)</button>
                            <span id="copyMessagePaso23" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>

                        <div class="p-4 bg-slate-100 rounded-lg border border-slate-300">
                            <label class="block text-sm font-semibold text-slate-700 mb-2">Paso 3: Ejecuta este prompt para encontrar Antecedentes Locales (paso24)</label>
                            <textarea id="prompt24" class="w-full h-32 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso24" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso24)</button>
                            <span id="copyMessagePaso24" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>

                            <label class="block text-sm font-semibold text-slate-700 mb-2 mt-4">Mejora la redacción de los Antecedentes Locales (paso25)</label>
                            <textarea id="prompt25" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso25" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso25)</button>
                            <span id="copyMessagePaso25" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>

                            <label class="block text-sm font-semibold text-slate-700 mb-2 mt-4">Genera las referencias de los Antecedentes Locales (paso26)</label>
                            <textarea id="prompt26" class="w-full h-20 p-3 text-slate-700 bg-white border border-slate-300 rounded-md resize-y" readonly></textarea>
                            <button id="copyPromptPaso26" class="mt-2 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-2 px-4 rounded-lg shadow-sm text-sm">Copiar prompt (paso26)</button>
                            <span id="copyMessagePaso26" class="ml-3 text-sm text-emerald-600 opacity-0 transition-opacity duration-300">¡Copiado!</span>
                        </div>
                    </div>
                `;
                setupAntecedentesEstudioTab();
            }
            else { 
                tabContentContainer.innerHTML = `
                    <h3 class="text-xl font-semibold text-slate-600 mb-4">${tabInfo.title}</h3>
                    <p class="text-slate-500">Contenido para esta pestaña (${tabInfo.title}) se definirá más adelante.</p>
                `;
                if (tabInfo.promptGenerator) {
                     // setupPromptGeneration(tabInfo, null, 'tabGeneratePromptButton', 'tabPromptOutput', 'tabCopyPromptButton', 'tabCopyMessage');
                }
            }
        }

        function setupDelimitarTab() {
            const generateBtn = document.getElementById('generatePromptPaso1');
            const copyBtn = document.getElementById('copyPromptPaso1');
            const promptOutputContainer = document.getElementById('promptPaso1Container');
            const promptTextarea = document.getElementById('prompt1');

            const nivelAcademicoEl = document.getElementById('nivelAcademico');
            const ideaInvestigacionEl = document.getElementById('ideaInvestigacion');
            const enfoqueInvestigacionEl = document.getElementById('enfoqueInvestigacion');
            const disenoInvestigacionEl = document.getElementById('disenoInvestigacion');

            const errorNivel = document.getElementById('errorNivelAcademico');
            const errorIdea = document.getElementById('errorIdeaInvestigacion');
            const errorEnfoque = document.getElementById('errorEnfoqueInvestigacion');
            const errorDiseno = document.getElementById('errorDisenoInvestigacion');

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                [nivelAcademicoEl, ideaInvestigacionEl, enfoqueInvestigacionEl, disenoInvestigacionEl].forEach(el => el.classList.remove('input-error'));
                [errorNivel, errorIdea, errorEnfoque, errorDiseno].forEach(el => el.classList.add('hidden'));

                if (!nivelAcademicoEl.value) { nivelAcademicoEl.classList.add('input-error'); errorNivel.classList.remove('hidden'); isValid = false; }
                if (!ideaInvestigacionEl.value.trim()) { ideaInvestigacionEl.classList.add('input-error'); errorIdea.classList.remove('hidden'); isValid = false; }
                if (!enfoqueInvestigacionEl.value) { enfoqueInvestigacionEl.classList.add('input-error'); errorEnfoque.classList.remove('hidden'); isValid = false; }
                if (!disenoInvestigacionEl.value.trim()) { disenoInvestigacionEl.classList.add('input-error'); errorDiseno.classList.remove('hidden'); isValid = false; }

                if (isValid) {
                    promptOutputContainer.classList.remove('hidden');
                    const nivel = nivelAcademicoEl.value;
                    const idea = ideaInvestigacionEl.value.trim();
                    const enfoque = enfoqueInvestigacionEl.value;
                    const diseno = disenoInvestigacionEl.value.trim();
                    promptTextarea.value = `Actúa como un docente experto en investigación con amplia experiencia en elaboración de tesis de [${nivel}]. Estoy comenzando una tesis y necesito ideas innovadoras y relevantes que puedan llenar un vacío en la literatura existente. Mi interés particular se centra en este tema de investigación [${idea}].
Además, considerando las tendencias actuales en el campo, sugiero al menos 3 preguntas de investigación potencialmente impactantes que podría guiar mi tesis, delimitando a este enfoque de investigación: [${enfoque}] y para este diseño metodológico: [${diseno}]
Por cada pregunta de investigación presenta lo siguiente:
- Pregunta de investigación.
- Tema delimitado.
- Problema de investigación.
- 3 causas posibles del problema de investigación.
- Variables de investigación: variable independiente o variable dependiente si lo tuviera.
- Instrumentos de investigación adecuados para abordar estas preguntas.
- Posibles desafíos que podría enfrentar al investigar con este método y cómo superarlos.
Presenta toda la información en Español.`;
                } else {
                    promptOutputContainer.classList.add('hidden');
                }
            });
            copyBtn.addEventListener('click', () => copiarAlPortapapeles('prompt1', 'copyMessagePaso1'));
        }

        function setupProblemaTab() {
            const generateBtn = document.getElementById('generatePromptPaso2');
            const copyBtn = document.getElementById('copyPromptPaso2');
            const promptOutputContainer = document.getElementById('promptPaso2Container');
            const promptTextarea = document.getElementById('prompt2');

            const temaDelimitadoEl = document.getElementById('problemaTemaDelimitado');
            const dondeEl = document.getElementById('problemaDonde');
            const aQuienEl = document.getElementById('problemaAQuien');
            const periodoEl = document.getElementById('problemaPeriodo');

            const errorTema = document.getElementById('errorProblemaTemaDelimitado');
            const errorDonde = document.getElementById('errorProblemaDonde');
            const errorAQuien = document.getElementById('errorProblemaAQuien');
            const errorPeriodo = document.getElementById('errorProblemaPeriodo');

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                [temaDelimitadoEl, dondeEl, aQuienEl, periodoEl].forEach(el => el.classList.remove('input-error'));
                [errorTema, errorDonde, errorAQuien, errorPeriodo].forEach(el => el.classList.add('hidden'));

                if (!temaDelimitadoEl.value.trim()) { temaDelimitadoEl.classList.add('input-error'); errorTema.classList.remove('hidden'); isValid = false; }
                if (!dondeEl.value.trim()) { dondeEl.classList.add('input-error'); errorDonde.classList.remove('hidden'); isValid = false; }
                if (!aQuienEl.value.trim()) { aQuienEl.classList.add('input-error'); errorAQuien.classList.remove('hidden'); isValid = false; }
                if (!periodoEl.value.trim()) { periodoEl.classList.add('input-error'); errorPeriodo.classList.remove('hidden'); isValid = false; }
                
                const nivelAcademicoDelimitar = document.getElementById('nivelAcademico')?.value || "Pregrado"; 
                const enfoqueInvestigacionDelimitar = document.getElementById('enfoqueInvestigacion')?.value || "Cuantitativo"; 
                const disenoInvestigacionDelimitar = document.getElementById('disenoInvestigacion')?.value || "descriptivo-propositivo"; 

                if (isValid) {
                    promptOutputContainer.classList.remove('hidden');
                    const temaDelimitado = temaDelimitadoEl.value.trim();
                    const donde = dondeEl.value.trim();
                    const aQuien = aQuienEl.value.trim();
                    const periodo = periodoEl.value.trim();

                    promptTextarea.value = `Quiero que generes el problema general y 4 problemas específicos para una tesis de [${nivelAcademicoDelimitar}]. Antes de redactar debes tener en cuenta lo siguiente:\n- Tema delimitado: [${temaDelimitado}].\n- Enfoque de investigación: [${enfoqueInvestigacionDelimitar}].\n- Alcance o diseño metodológico: [${disenoInvestigacionDelimitar}].\n\n- ¿En dónde haz identificado el problema?: [${donde}].\n\n- ¿A quién vas a realizar el estudio?: [${aQuien}].\n\n- ¿Cuál es el período donde analizarás el problema?: [${periodo}].\n\nLa estructura de redacción debe ser:\n\nProblema General:\n\n- Formúlalo en forma de pregunta.\n\n- Debe abordar el tema central de la investigación de manera específica y clara.\n\n- Incluye en dónde haz identificado el problema, a quién vas a realizar el estudio, y el período donde analizarás el problema.\n\nProblemas Específicos:\n\n- Formúlalos en forma de preguntas.\n\n- Cada problema específico debe abordar un aspecto particular del problema general.\n\n- Deben ser claros, precisos y directamente relacionados con el problema general.`;
                } else {
                    promptOutputContainer.classList.add('hidden');
                }
            });
            copyBtn.addEventListener('click', () => copiarAlPortapapeles('prompt2', 'copyMessagePaso2'));
        }

        function setupObjetivosTab() {
            const generateBtn = document.getElementById('generatePromptPaso3');
            const copyBtn = document.getElementById('copyPromptPaso3');
            const promptOutputContainer = document.getElementById('promptPaso3Container');
            const promptTextarea = document.getElementById('prompt3');

            const problemaInvestigacionEl = document.getElementById('objetivosProblemaInvestigacion');
            const cantidadObjetivosEl = document.getElementById('cantidadObjetivosEspecificos');

            const errorProblema = document.getElementById('errorObjetivosProblema');
            const errorCantidad = document.getElementById('errorCantidadObjetivos');

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                problemaInvestigacionEl.classList.remove('input-error');
                errorProblema.classList.add('hidden');
                cantidadObjetivosEl.classList.remove('input-error');
                errorCantidad.classList.add('hidden');


                if (!problemaInvestigacionEl.value.trim()) {
                    problemaInvestigacionEl.classList.add('input-error');
                    errorProblema.classList.remove('hidden');
                    isValid = false;
                }
                const cantidad = parseInt(cantidadObjetivosEl.value, 10);
                if (isNaN(cantidad) || cantidad <= 0) {
                    cantidadObjetivosEl.classList.add('input-error');
                    errorCantidad.classList.remove('hidden');
                    isValid = false;
                }
                
                const nivelAcademicoDelimitar = document.getElementById('nivelAcademico')?.value || "pregrado"; 
                const enfoqueInvestigacionDelimitar = document.getElementById('enfoqueInvestigacion')?.value || "cuantitativo"; 
                const disenoInvestigacionDelimitar = document.getElementById('disenoInvestigacion')?.value || "descriptivo-propositivo";

                if (isValid) {
                    promptOutputContainer.classList.remove('hidden');
                    const problemaInvestigacion = problemaInvestigacionEl.value.trim();
                    const numObjetivos = cantidadObjetivosEl.value;

                    promptTextarea.value = `Actúa como un experto el elaboración de tesis de [${nivelAcademicoDelimitar}] y elabora los objetivos de la tesis. La estructura debe incluir un objetivo general y [${numObjetivos}] objetivos específicos.
- El problema de investigación es: [${problemaInvestigacion}].
- El enfoque de investigación: [${enfoqueInvestigacionDelimitar}].
- El alcance o diseño de investigación: [${disenoInvestigacionDelimitar}].

A continuación, se detallan las instrucciones para la redacción:\u0020

Objetivo General:
- Debe ser una oración clara que describa la meta principal de la investigación.
- Debe centrarse en resolver el problema de investigación.
- Debe empezar con verbo en infinitivo.

Objetivos Específicos:
- Deben derivar del objetivo general.
- Debe empezar con verbo en infinitivo.
- Cada objetivo específico debe enfocarse en el problema de investigación específicos.
- Deben ser detallados y medibles.
- Asegúrate de que la redacción sea formal y académica, utilizando un lenguaje preciso y claro.

Presenta el texto: **Variables de investigación**
Extrae las variables independiente, dependiente o intervinientes.`;
                } else {
                    promptOutputContainer.classList.add('hidden');
                }
            });
            copyBtn.addEventListener('click', () => copiarAlPortapapeles('prompt3', 'copyMessagePaso3'));
        }

        function setupHipotesisTab() {
            const generateBtn = document.getElementById('generatePromptPaso4');
            const copyBtn = document.getElementById('copyPromptPaso4');
            const promptOutputContainer = document.getElementById('promptPaso4Container');
            const promptTextarea = document.getElementById('prompt4');

            const varIndependienteEl = document.getElementById('hipotesisVarIndependiente');
            const varDependienteEl = document.getElementById('hipotesisVarDependiente');

            const errorVarInd = document.getElementById('errorHipotesisVarInd');
            const errorVarDep = document.getElementById('errorHipotesisVarDep');

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                varIndependienteEl.classList.remove('input-error');
                errorVarInd.classList.add('hidden');
                varDependienteEl.classList.remove('input-error');
                errorVarDep.classList.add('hidden');

                if (!varIndependienteEl.value.trim()) {
                    varIndependienteEl.classList.add('input-error');
                    errorVarInd.classList.remove('hidden');
                    isValid = false;
                }
                if (!varDependienteEl.value.trim()) {
                    varDependienteEl.classList.add('input-error');
                    errorVarDep.classList.remove('hidden');
                    isValid = false;
                }
                
                const enfoqueInvestigacionDelimitar = document.getElementById('enfoqueInvestigacion')?.value || "cuantitativo"; 
                const disenoInvestigacionDelimitar = document.getElementById('disenoInvestigacion')?.value || "descriptivo-propositivo";

                if (isValid) {
                    promptOutputContainer.classList.remove('hidden');
                    const varIndependiente = varIndependienteEl.value.trim();
                    const varDependiente = varDependienteEl.value.trim();

                    promptTextarea.value = `Genera una hipótesis general y cuatro específicas, detalladas y que garanticen la comprobabilidad. Teniendo en cuenta las variables independiente [${varIndependiente}] y dependiente [${varDependiente}], el enfoque de investigación: [${enfoqueInvestigacionDelimitar}] y diseño metodológico: [${disenoInvestigacionDelimitar}].`;
                } else {
                    promptOutputContainer.classList.add('hidden');
                }
            });
            copyBtn.addEventListener('click', () => copiarAlPortapapeles('prompt4', 'copyMessagePaso4'));
        }

        function setupMatrizCompletaTab() {
            const generateBtn = document.getElementById('generatePromptPaso5');
            const promptOutputContainer = document.getElementById('promptPaso5Container'); 
            
            const promptTextarea5 = document.getElementById('prompt5');
            const copyBtn5 = document.getElementById('copyPromptPaso5');
            
            const promptTextarea6 = document.getElementById('prompt6');
            const copyBtn6 = document.getElementById('copyPromptPaso6');

            generateBtn.addEventListener('click', () => {
                promptOutputContainer.classList.remove('hidden');
                
                promptTextarea5.value = `De toda la información anteriormente entregada genera una matriz de consistencia. Presenta la información en Tabla con las siguientes columnas:

1. Pregunta de investigación.
2. Enfoque y alcance de la investigación.
3. Problema de investigación.
4. Objetivos de la investigación (objetivo general y objetivos específicos).
5. Variables de estudio.
6. Hipótesis.

Instrucciones Adicionales: Asegúrate de que la tabla sea coherente, detallada y fácil de leer. La información debe estar alineada lógicamente, mostrando la consistencia interna entre los elementos.`;

                promptTextarea6.value = `Encuentra investigaciones similares a este PDF. Por favor analiza de manera exhaustiva la información.`;
            });

            copyBtn5.addEventListener('click', () => copiarAlPortapapeles('prompt5', 'copyMessagePaso5'));
            copyBtn6.addEventListener('click', () => copiarAlPortapapeles('prompt6', 'copyMessagePaso6'));
        }

        function setupTitulosTab() {
            const generateBtn = document.getElementById('generatePromptPaso7'); 
            const promptOutputContainer = document.getElementById('promptPaso7Container');
            const promptTextarea = document.getElementById('prompt7');
            const copyBtn = document.getElementById('copyPromptPaso7');

            generateBtn.addEventListener('click', () => {
                promptOutputContainer.classList.remove('hidden');
                promptTextarea.value = `De toda la información anteriormente entregada, elabora 5 ejemplos de buenos títulos para mi tesis y luego justifica brevemente por qué usar el título. Presenta todo en español.`;
            });
            copyBtn.addEventListener('click', () => copiarAlPortapapeles('prompt7', 'copyMessagePaso7'));
        }
        
        function setupRealidadProblemáticaTab() {
            const generateBtn = document.getElementById('generatePromptPaso12');
            const promptsContainer = document.getElementById('promptsRealidadProblematicasContainer');

            const filtroInternacionalEl = document.getElementById('filtroInternacional');
            const filtroNacionalEl = document.getElementById('filtroNacional');
            
            const errorFiltroInternacional = document.getElementById('errorFiltroInternacional');
            const errorFiltroNacional = document.getElementById('errorFiltroNacional');

            const prompt12Textarea = document.getElementById('prompt12');
            const prompt13Textarea = document.getElementById('prompt13');

            document.getElementById('copyPromptPaso12').addEventListener('click', () => copiarAlPortapapeles('prompt12', 'copyMessagePaso12'));
            document.getElementById('copyPromptPaso13').addEventListener('click', () => copiarAlPortapapeles('prompt13', 'copyMessagePaso13'));

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                filtroInternacionalEl.classList.remove('input-error');
                errorFiltroInternacional.classList.add('hidden');
                filtroNacionalEl.classList.remove('input-error');
                errorFiltroNacional.classList.add('hidden');

                if (!filtroInternacionalEl.value.trim()) {
                    filtroInternacionalEl.classList.add('input-error');
                    errorFiltroInternacional.classList.remove('hidden');
                    isValid = false;
                }
                if (!filtroNacionalEl.value.trim()) {
                    filtroNacionalEl.classList.add('input-error');
                    errorFiltroNacional.classList.remove('hidden');
                    isValid = false;
                }

                const problemaInvestigacionPT = proyectoTesisData.formulacionProblema || "[Problema de investigación no definido en Proyecto de Tesis]";
                const enfoqueInvestigacionPT = proyectoTesisData.enfoqueInvestigacion || "[Enfoque no definido en Proyecto de Tesis]";
                const disenoInvestigacionPT = proyectoTesisData.disenoInvestigacion || "[Diseño no definido en Proyecto de Tesis]";
                const objetivoGeneralPT = proyectoTesisData.objetivoGeneral || "[Objetivo general no definido en Proyecto de Tesis]";


                if (isValid) {
                    promptsContainer.classList.remove('hidden');
                    const filtroInternacional = filtroInternacionalEl.value.trim();
                    const filtroNacional = filtroNacionalEl.value.trim();

                    prompt12Textarea.value = `Elabora la redacción del apartado Realidad problemática para una tesis. Ten en cuenta la siguiente información:
- Problema de investigación: [${problemaInvestigacionPT}].
- Enfoque de investigación: [${enfoqueInvestigacionPT}].
- Alcance o diseño de investigación: [${disenoInvestigacionPT}].
- Objetivo general de la investigación: [${objetivoGeneralPT}]
\u0020
Sigue la estructura y lógica de redacción detalladas a continuación:
Introducción al Problema:
Presenta de manera concisa y directa el problema identificado en el contexto de las variables relacionadas con el problema de investigación. Organiza las ideas de manera lógica y objetiva.
Contextualización Internacional:
Contextualiza la situación problemática a nivel internacional, apoyándote en [${filtroInternacional}]. Utiliza estos datos para reforzar la argumentación sobre el problema de investigación.
Contextualización Nacional:
Del mismo modo, contextualiza la situación problemática a nivel nacional, incluyendo [${filtroNacional}], que ofrezcan cifras y análisis sobre el problema de investigación en el país.
Citas Bibliográficas:
Asegúrate de que todas las citas estén formateadas según las normas de [APA, 7ª edición], para respaldar adecuadamente los argumentos presentados.
Consideraciones Adicionales:
- Asegúrate de que la redacción sea clara, coherente y persuasiva, utilizando un lenguaje académico adecuado.
- Mantén una estructura lógica y fluida que guíe al lector a través del texto, facilitando la comprensión del problema y su relevancia.`;

                    prompt13Textarea.value = `Del texto anterior genera las referencias bibliográficas en estilo bibliográfico [APA, 7ª edición].`;
                } else {
                    promptsContainer.classList.add('hidden');
                }
            });
        }
        
        function setupDelimitacionProblemaTab() {
            const generateBtn = document.getElementById('generatePromptPaso14');
            const promptsContainer = document.getElementById('promptsDelimitacionContainer');
            const filtroDelimitacionEl = document.getElementById('filtroDelimitacion');
            const errorFiltroDelimitacion = document.getElementById('errorFiltroDelimitacion');
            const prompt14Textarea = document.getElementById('prompt14');
            const prompt15Textarea = document.getElementById('prompt15');

            document.getElementById('copyPromptPaso14').addEventListener('click', () => copiarAlPortapapeles('prompt14', 'copyMessagePaso14'));
            document.getElementById('copyPromptPaso15').addEventListener('click', () => copiarAlPortapapeles('prompt15', 'copyMessagePaso15'));

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                filtroDelimitacionEl.classList.remove('input-error');
                errorFiltroDelimitacion.classList.add('hidden');

                if (!filtroDelimitacionEl.value.trim()) {
                    filtroDelimitacionEl.classList.add('input-error');
                    errorFiltroDelimitacion.classList.remove('hidden');
                    isValid = false;
                }

                const problemaInvestigacionPT = proyectoTesisData.formulacionProblema || "[Problema de investigación no definido en Proyecto de Tesis]";
                const enfoqueInvestigacionPT = proyectoTesisData.enfoqueInvestigacion || "[Enfoque no definido en Proyecto de Tesis]";
                const disenoInvestigacionPT = proyectoTesisData.disenoInvestigacion || "[Diseño no definido en Proyecto de Tesis]";
                const objetivoGeneralPT = proyectoTesisData.objetivoGeneral || "[Objetivo general no definido en Proyecto de Tesis]";

                if (isValid) {
                    promptsContainer.classList.remove('hidden');
                    const filtroDelimitacion = filtroDelimitacionEl.value.trim();

                    prompt14Textarea.value = `Elabora la redacción del apartado de delimitación del problema de investigación utilizando la siguiente información:
- Problema de investigación: [${problemaInvestigacionPT}].
- Enfoque de investigación: [${enfoqueInvestigacionPT}].
- Alcance o diseño de investigación: [${disenoInvestigacionPT}].
- Objetivo general de la investigación: [${objetivoGeneralPT}].

Estructura y Lógica de Redacción:
Delimitación espacial:
Delimita el espacio en el cual se desarrollará la investigación (sector, distrito, provincia, región).
Delimitación temporal:
Delimita la temporalidad de la investigación se tiene en cuenta el momento al cual corresponde la información que se tomará para la investigación.
Delimitación teórica o académica:
Delimita el ámbito teórico de la investigación se tiene en cuenta el alcance teórico y conceptual al que se limita la investigación. Apóyate en [${filtroDelimitacion}]
Citas Bibliográficas:
Asegúrate de que todas las citas estén formateadas según las normas de [APA, 7ª edición], para respaldar adecuadamente los argumentos presentados.
Consideraciones Adicionales:
- La redacción debe ser clara, coherente y persuasiva, utilizando un lenguaje académico adecuado.
- Mantén una estructura lógica y fluida que guíe al lector a través de la argumentación de manera efectiva.`;
                    
                    prompt15Textarea.value = `Del texto anterior genera las referencias bibliográficas en estilo bibliográfico [APA, 7ª edición].`;
                } else {
                    promptsContainer.classList.add('hidden');
                }
            });
        }

        function setupJustificacionTab() {
            const generateBtn = document.getElementById('generatePromptPaso16');
            const promptsContainer = document.getElementById('promptsJustificacionContainer');
            const filtroJustificacionEl = document.getElementById('filtroJustificacion');
            const errorFiltroJustificacion = document.getElementById('errorFiltroJustificacion');
            const prompt16Textarea = document.getElementById('prompt16');
            const prompt17Textarea = document.getElementById('prompt17');

            document.getElementById('copyPromptPaso16').addEventListener('click', () => copiarAlPortapapeles('prompt16', 'copyMessagePaso16'));
            document.getElementById('copyPromptPaso17').addEventListener('click', () => copiarAlPortapapeles('prompt17', 'copyMessagePaso17'));

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                filtroJustificacionEl.classList.remove('input-error');
                errorFiltroJustificacion.classList.add('hidden');

                if (!filtroJustificacionEl.value.trim()) {
                    filtroJustificacionEl.classList.add('input-error');
                    errorFiltroJustificacion.classList.remove('hidden');
                    isValid = false;
                }

                const problemaInvestigacionPT = proyectoTesisData.formulacionProblema || "[Problema de investigación no definido en Proyecto de Tesis]";
                const enfoqueInvestigacionPT = proyectoTesisData.enfoqueInvestigacion || "[Enfoque no definido en Proyecto de Tesis]";
                const disenoInvestigacionPT = proyectoTesisData.disenoInvestigacion || "[Diseño no definido en Proyecto de Tesis]";
                const objetivoGeneralPT = proyectoTesisData.objetivoGeneral || "[Objetivo general no definido en Proyecto de Tesis]";

                if (isValid) {
                    promptsContainer.classList.remove('hidden');
                    const filtroJustificacion = filtroJustificacionEl.value.trim();

                    prompt16Textarea.value = `Elabora la redacción del apartado Justificación de la investigación para una tesis. Ten en cuenta la siguiente información:
- Problema de investigación: [${problemaInvestigacionPT}].
- Enfoque de investigación: [${enfoqueInvestigacionPT}].
- Alcance o diseño de investigación: [${disenoInvestigacionPT}].
- Objetivo general de la investigación: [${objetivoGeneralPT}].
\u0020
Sigue la estructura y lógica de redacción detalladas a continuación:
- La justificación teórica de la investigación orienta el enfoque o la perspectiva de la investigación. Explica las teorías que se van a utilizar como referencia para el estudio y Destaca las nuevas contribuciones que la investigación aportará para la solución del problema a resolver o para el avance del conocimiento. Debe contribuir a generar reflexión y debate académico sobre el conocimiento existente. Apóyate en [${filtroJustificacion}].
- La justificación práctica consiste en explicar la contribución de la investigación a resolver un problema o, al menos, propone estrategias que podrían ayudar a resolverlo. Se basa en razonamientos técnicos y prácticos que destacan la utilidad y relevancia de la investigación, haciendo hincapié en los beneficios sociales, económicos, educativos u otros que pueda generar. La justificación práctica busca responder a la pregunta sobre qué propósito cumple la investigación a desarrollar, y debe ser clara, objetiva y convincente en su argumentación. Apóyate en [${filtroJustificacion}].
- La justificación académica explica la relevancia y la necesidad de contribuir a las líneas de investigación y el potencial impacto de los resultados de la investigación en la comunidad académica (de la universidad). La justificación académica se basa en una actitud crítica, reflexiva y ética según el nivel de conocimiento y experiencia del investigador con el compromiso de brindar información pertinente y confiable con la investigación. Apóyate en [${filtroJustificacion}].
Consideraciones Adicionales:
- Asegúrate de que la redacción sea clara, coherente y persuasiva, utilizando un lenguaje académico adecuado.
- Mantén una estructura lógica y fluida que guíe al lector.`;
                    
                    prompt17Textarea.value = `Del texto anterior genera las referencias bibliográficas en estilo bibliográfico [APA, 7ª edición].`;
                } else {
                    promptsContainer.classList.add('hidden');
                }
            });
        }

        function setupAntecedentesEstudioTab() {
            const generateBtn = document.getElementById('generatePromptPaso18');
            const promptsContainer = document.getElementById('promptsAntecedentesContainer');

            const tipoTesisEl = document.getElementById('antecedentesTipoTesis');
            const palabrasClaveEl = document.getElementById('antecedentesPalabrasClave');
            const anioInicioEl = document.getElementById('antecedentesRangoAnioInicio');
            const anioFinEl = document.getElementById('antecedentesRangoAnioFin');
            const paisesInternacionalEl = document.getElementById('antecedentesPaisesInternacional');
            const paisNacionalEl = document.getElementById('antecedentesPaisNacional');
            const lugarLocalEl = document.getElementById('antecedentesLugarLocal');

            // Elementos de error
            const errorTipoTesis = document.getElementById('errorAntecedentesTipoTesis');
            const errorPalabrasClave = document.getElementById('errorAntecedentesPalabrasClave');
            const errorRangoAnios = document.getElementById('errorAntecedentesRangoAnios');
            const errorPaisesInt = document.getElementById('errorAntecedentesPaisesInternacional');
            const errorPaisNac = document.getElementById('errorAntecedentesPaisNacional');
            const errorLugarLocal = document.getElementById('errorAntecedentesLugarLocal');
            
            // Textareas de prompts
            const prompt18Textarea = document.getElementById('prompt18');
            const prompt19Textarea = document.getElementById('prompt19');
            const prompt20Textarea = document.getElementById('prompt20');
            const prompt21Textarea = document.getElementById('prompt21');
            const prompt22Textarea = document.getElementById('prompt22');
            const prompt23Textarea = document.getElementById('prompt23');
            const prompt24Textarea = document.getElementById('prompt24');
            const prompt25Textarea = document.getElementById('prompt25');
            const prompt26Textarea = document.getElementById('prompt26');

            // Botones de copiar
            document.getElementById('copyPromptPaso18').addEventListener('click', () => copiarAlPortapapeles('prompt18', 'copyMessagePaso18'));
            document.getElementById('copyPromptPaso19').addEventListener('click', () => copiarAlPortapapeles('prompt19', 'copyMessagePaso19'));
            document.getElementById('copyPromptPaso20').addEventListener('click', () => copiarAlPortapapeles('prompt20', 'copyMessagePaso20'));
            document.getElementById('copyPromptPaso21').addEventListener('click', () => copiarAlPortapapeles('prompt21', 'copyMessagePaso21'));
            document.getElementById('copyPromptPaso22').addEventListener('click', () => copiarAlPortapapeles('prompt22', 'copyMessagePaso22'));
            document.getElementById('copyPromptPaso23').addEventListener('click', () => copiarAlPortapapeles('prompt23', 'copyMessagePaso23'));
            document.getElementById('copyPromptPaso24').addEventListener('click', () => copiarAlPortapapeles('prompt24', 'copyMessagePaso24'));
            document.getElementById('copyPromptPaso25').addEventListener('click', () => copiarAlPortapapeles('prompt25', 'copyMessagePaso25'));
            document.getElementById('copyPromptPaso26').addEventListener('click', () => copiarAlPortapapeles('prompt26', 'copyMessagePaso26'));


            generateBtn.addEventListener('click', () => {
                let isValid = true;
                // Resetear errores
                [tipoTesisEl, palabrasClaveEl, anioInicioEl, anioFinEl, paisesInternacionalEl, paisNacionalEl, lugarLocalEl].forEach(el => el.classList.remove('input-error'));
                [errorTipoTesis, errorPalabrasClave, errorRangoAnios, errorPaisesInt, errorPaisNac, errorLugarLocal].forEach(el => el.classList.add('hidden'));
                
                if (!tipoTesisEl.value) { tipoTesisEl.classList.add('input-error'); errorTipoTesis.classList.remove('hidden'); isValid = false; }
                if (!palabrasClaveEl.value.trim()) { palabrasClaveEl.classList.add('input-error'); errorPalabrasClave.classList.remove('hidden'); isValid = false; }
                if (!anioInicioEl.value.trim() || !anioFinEl.value.trim() || parseInt(anioInicioEl.value) > parseInt(anioFinEl.value)) {
                    anioInicioEl.classList.add('input-error');
                    anioFinEl.classList.add('input-error');
                    errorRangoAnios.classList.remove('hidden');
                    isValid = false;
                }
                if (!paisesInternacionalEl.value.trim()) { paisesInternacionalEl.classList.add('input-error'); errorPaisesInt.classList.remove('hidden'); isValid = false; }
                if (!paisNacionalEl.value.trim()) { paisNacionalEl.classList.add('input-error'); errorPaisNac.classList.remove('hidden'); isValid = false; }
                if (!lugarLocalEl.value.trim()) { lugarLocalEl.classList.add('input-error'); errorLugarLocal.classList.remove('hidden'); isValid = false; }


                if (isValid) {
                    promptsContainer.classList.remove('hidden');
                    const tipoTesis = tipoTesisEl.value;
                    const palabrasClave = palabrasClaveEl.value.trim();
                    const anioInicio = anioInicioEl.value;
                    const anioFin = anioFinEl.value;
                    const paisesInt = paisesInternacionalEl.value.trim();
                    const paisNac = paisNacionalEl.value.trim();
                    const lugarLocal = lugarLocalEl.value.trim();

                    prompt18Textarea.value = `Encuentra 3 tesis [${tipoTesis}] de estos países internacionales [${paisesInt}], con estas palabras clave [${palabrasClave}] y este rango de años [${anioInicio} al ${anioFin}]. Luego redacta en función de esta estructura:\n- Autor y título de la fuente.\n- Objetivo de la investigación.\n- Metodología.\n- Resultados más relevantes.\n\n- Conclusión más relevante.`;
                    prompt19Textarea.value = `Del resultado anterior, redacta todo en párrafos. Asegúrate de que la redacción sea formal y académica, utilizando un lenguaje preciso y claro`;
                    prompt20Textarea.value = `Del texto anterior genera las referencias bibliográficas en estilo bibliográfico [APA, 7ª edición].`;
                    
                    prompt21Textarea.value = `Encuentra 3 tesis [${tipoTesis}] a nivel nacional de este país [${paisNac}], con estas palabras clave [${palabrasClave}] y este rango de años [${anioInicio} al ${anioFin}]. Luego redacta en función de esta estructura:\n- Autor y título de la fuente.\n- Objetivo de la investigación.\n- Metodología.\n- Resultados más relevantes.\n\n- Conclusión más relevante.`;
                    prompt22Textarea.value = `Del resultado anterior, redacta todo en párrafos. Asegúrate de que la redacción sea formal y académica, utilizando un lenguaje preciso y claro`;
                    prompt23Textarea.value = `Del texto anterior genera las referencias bibliográficas en estilo bibliográfico [APA, 7ª edición].`;

                    prompt24Textarea.value = `Encuentra 3 tesis [${tipoTesis}] a nivel de [${lugarLocal}], con estas palabras clave [${palabrasClave}] y este rango de años [${anioInicio} al ${anioFin}]. Luego redacta en función de esta estructura:\n- Autor y título de la fuente.\n- Objetivo de la investigación.\n- Metodología.\n- Resultados más relevantes.\n\n- Conclusión más relevante.`;
                    prompt25Textarea.value = `Del resultado anterior, redacta todo en párrafos. Asegúrate de que la redacción sea formal y académica, utilizando un lenguaje preciso y claro`;
                    prompt26Textarea.value = `Del texto anterior genera las referencias bibliográficas en estilo bibliográfico [APA, 7ª edición].`;

                } else {
                    promptsContainer.classList.add('hidden');
                }
            });
        }


        function copiarAlPortapapeles(textareaId, messageId) {
            const textarea = document.getElementById(textareaId);
            const copyMessageEl = document.getElementById(messageId);

            if (!textarea || !copyMessageEl) {
                console.error("Error: Textarea o mensaje de copia no encontrado.", textareaId, messageId);
                return;
            }

            textarea.select();
            textarea.setSelectionRange(0, 99999); 

            try {
                var successful = document.execCommand('copy');
                var msg = successful ? '¡Copiado!' : 'Error al copiar';
                copyMessageEl.textContent = msg;
                copyMessageEl.classList.remove('opacity-0');
                setTimeout(() => {
                    copyMessageEl.classList.add('opacity-0');
                }, 2000);
            } catch (err) {
                console.error('Error al copiar el texto: ', err);
                copyMessageEl.textContent = 'Error al copiar';
                copyMessageEl.classList.remove('opacity-0');
                setTimeout(() => {
                    copyMessageEl.classList.add('opacity-0');
                }, 2000);
            }
        }
        
        function setupPromptGeneration(itemOrTabInfo, titleInputIdOrElement, generateButtonId, outputId, copyButtonId, copyMessageId) {
            const generateButton = document.getElementById(generateButtonId);
            const outputTextarea = document.getElementById(outputId);
            
            if (!generateButton || !outputTextarea ) {
                return;
            }
            const copyButton = document.getElementById(copyButtonId); 
            const copyMessageSpan = document.getElementById(copyMessageId);

            generateButton.addEventListener('click', () => {
                let tesisTitleForPrompt = "[Título de tu Tesis]"; 
                if (titleInputIdOrElement) { 
                    const inputElement = typeof titleInputIdOrElement === 'string' 
                        ? document.getElementById(titleInputIdOrElement) 
                        : titleInputIdOrElement; 
                    if (inputElement && typeof inputElement.value === 'string') { 
                        tesisTitleForPrompt = inputElement.value.trim() || "[Título de tu Tesis]";
                    }
                }
                if (typeof itemOrTabInfo.promptGenerator === 'function') {
                    const promptText = itemOrTabInfo.promptGenerator(tesisTitleForPrompt);
                    outputTextarea.value = promptText;
                }
            });

            if (copyButton && copyMessageSpan) { 
                copyButton.addEventListener('click', () => {
                    copiarAlPortapapeles(outputId, copyMessageId);
                });
            }
        }

        function setupMatrizOperacionalizacion() {
            const generateBtn = document.getElementById('generatePromptPaso8');
            const promptsContainer = document.getElementById('promptsOperacionalizacionContainer');

            const nivelAcademicoEl = document.getElementById('opNivelAcademico');
            const enfoqueInvestigacionEl = document.getElementById('opEnfoqueInvestigacion');
            const disenoInvestigacionEl = document.getElementById('opDisenoInvestigacion');
            const varIndependienteEl = document.getElementById('opVarIndependiente');
            const varDependienteEl = document.getElementById('opVarDependiente');
            const rangoAnioInicioEl = document.getElementById('opRangoAnioInicio');
            const rangoAnioFinEl = document.getElementById('opRangoAnioFin');
            const filtroDbEl = document.getElementById('opFiltroDb');

            const errorNivel = document.getElementById('errorOpNivelAcademico');
            const errorEnfoque = document.getElementById('errorOpEnfoqueInvestigacion');
            const errorDiseno = document.getElementById('errorOpDisenoInvestigacion');
            const errorVarInd = document.getElementById('errorOpVarIndependiente');
            const errorVarDep = document.getElementById('errorOpVarDependiente');
            const errorRango = document.getElementById('errorOpRangoAnios');
            const errorFiltro = document.getElementById('errorOpFiltroDb');

            const prompt8Textarea = document.getElementById('prompt8');
            const prompt9Textarea = document.getElementById('prompt9');
            const prompt10Textarea = document.getElementById('prompt10');
            const prompt11Textarea = document.getElementById('prompt11');

            document.getElementById('copyPromptPaso8').addEventListener('click', () => copiarAlPortapapeles('prompt8', 'copyMessagePaso8'));
            document.getElementById('copyPromptPaso9').addEventListener('click', () => copiarAlPortapapeles('prompt9', 'copyMessagePaso9'));
            document.getElementById('copyPromptPaso10').addEventListener('click', () => copiarAlPortapapeles('prompt10', 'copyMessagePaso10'));
            document.getElementById('copyPromptPaso11').addEventListener('click', () => copiarAlPortapapeles('prompt11', 'copyMessagePaso11'));

            generateBtn.addEventListener('click', () => {
                let isValid = true;
                [nivelAcademicoEl, enfoqueInvestigacionEl, disenoInvestigacionEl, varIndependienteEl, varDependienteEl, rangoAnioInicioEl, rangoAnioFinEl, filtroDbEl].forEach(el => el.classList.remove('input-error'));
                [errorNivel, errorEnfoque, errorDiseno, errorVarInd, errorVarDep, errorRango, errorFiltro].forEach(el => el.classList.add('hidden'));

                if (!nivelAcademicoEl.value) { nivelAcademicoEl.classList.add('input-error'); errorNivel.classList.remove('hidden'); isValid = false;}
                if (!enfoqueInvestigacionEl.value) { enfoqueInvestigacionEl.classList.add('input-error'); errorEnfoque.classList.remove('hidden'); isValid = false;}
                if (!disenoInvestigacionEl.value.trim()) { disenoInvestigacionEl.classList.add('input-error'); errorDiseno.classList.remove('hidden'); isValid = false;}
                if (!varIndependienteEl.value.trim()) { varIndependienteEl.classList.add('input-error'); errorVarInd.classList.remove('hidden'); isValid = false;}
                if (!varDependienteEl.value.trim()) { varDependienteEl.classList.add('input-error'); errorVarDep.classList.remove('hidden'); isValid = false;}
                if (!rangoAnioInicioEl.value.trim() || !rangoAnioFinEl.value.trim() || parseInt(rangoAnioInicioEl.value) > parseInt(rangoAnioFinEl.value) ) { rangoAnioInicioEl.classList.add('input-error'); rangoAnioFinEl.classList.add('input-error'); errorRango.classList.remove('hidden'); isValid = false;}
                if (!filtroDbEl.value.trim()) { filtroDbEl.classList.add('input-error'); errorFiltro.classList.remove('hidden'); isValid = false;}


                if (isValid) {
                    promptsContainer.classList.remove('hidden');
                    const nivel = nivelAcademicoEl.value;
                    const enfoque = enfoqueInvestigacionEl.value;
                    const diseno = disenoInvestigacionEl.value.trim();
                    const varInd = varIndependienteEl.value.trim();
                    const varDep = varDependienteEl.value.trim();
                    const anioInicio = rangoAnioInicioEl.value;
                    const anioFin = rangoAnioFinEl.value;
                    const filtroDb = filtroDbEl.value.trim();

                    prompt8Textarea.value = `Actúa como un experto en la elaboración de tesis de [${nivel}] y genera una Matriz de Operacionalización de Variables basada en la siguiente información:
Enfoque de investigación: [${enfoque}].
Diseño metodológico: [${diseno}].
Variables:
- Variable independiente: [${varInd}].
- Variable dependiente: [${varDep}].

Instrucciones Detalladas:
- Definición Conceptual: Para cada variable, proporciona una definición conceptual clara y precisa, basada en dos fuentes teóricas relevantes publicadas [entre ${anioInicio} y ${anioFin}] y de las bases de datos [${filtroDb}].
- Definición Operacional: Explica cómo se va a medir cada variable en términos operacionales. Indica el instrumento específico que se utilizará para la medición, como un cuestionario, una entrevista u otro método pertinente.
- Dimensiones de la Variable: Desglosa cada variable en sus dimensiones clave, especificando cómo se miden. Asegúrate de que cada dimensión esté claramente vinculada a la variable y sea medible.
- Indicadores: Define los indicadores específicos para cada variable, respondiendo a la pregunta: ¿Qué indica esta variable o dimensión en términos medibles?

Formato de Presentación:
Presenta en español la información en una tabla estructurada con las siguientes columnas:
Variable independiente
Variable dependiente
Definición Conceptual
Definición Operacional
Dimensiones
Indicadores

Asegúrate de que la tabla sea clara, coherente y fácil de entender, facilitando así la visualización y comprensión de la operacionalización de las variables.`;

                    prompt9Textarea.value = `Genera otra tabla, pero filtra que las fuentes sean de México, Ecuador o Perú`;
                    prompt10Textarea.value = `Del texto anterior elabora una tabla con las variables y [los valores de medición]`; 
                    prompt11Textarea.value = `Del texto anterior genera las referencias en [apa 7ma edición]. Por favor no olvides incluir la URL o link respectivo.`;

                } else {
                    promptsContainer.classList.add('hidden');
                }
            });
        }

        function setupProyectoTesis(){
            const configurarBtn = document.getElementById('configurarProyectoBtn');
            const mensajeConfirmacion = document.getElementById('proyectoConfiguradoMessage');

            const nivelAcademicoEl = document.getElementById('ptNivelAcademico');
            const enfoqueEl = document.getElementById('ptEnfoqueInvestigacion');
            const disenoEl = document.getElementById('ptDisenoInvestigacion');
            const formulacionEl = document.getElementById('ptFormulacionProblema');
            const objGeneralEl = document.getElementById('ptObjetivoGeneral');
            const objEspecificosEl = document.getElementById('ptObjetivosEspecificos');
            const varIndependienteEl = document.getElementById('ptVarIndependiente'); // Nuevo
            const varDependienteEl = document.getElementById('ptVarDependiente');   // Nuevo


            const errorNivel = document.getElementById('errorPtNivelAcademico');
            const errorEnfoque = document.getElementById('errorPtEnfoqueInvestigacion');
            const errorDiseno = document.getElementById('errorPtDisenoInvestigacion');
            const errorFormulacion = document.getElementById('errorPtFormulacionProblema');
            const errorObjGeneral = document.getElementById('errorPtObjetivoGeneral');
            const errorObjEspecificos = document.getElementById('errorPtObjetivosEspecificos');
            const errorVarInd = document.getElementById('errorPtVarIndependiente'); // Nuevo
            const errorVarDep = document.getElementById('errorPtVarDependiente');   // Nuevo
            
            nivelAcademicoEl.value = proyectoTesisData.nivelAcademico;
            enfoqueEl.value = proyectoTesisData.enfoqueInvestigacion;
            disenoEl.value = proyectoTesisData.disenoInvestigacion;
            formulacionEl.value = proyectoTesisData.formulacionProblema;
            objGeneralEl.value = proyectoTesisData.objetivoGeneral;
            objEspecificosEl.value = proyectoTesisData.objetivosEspecificos;
            varIndependienteEl.value = proyectoTesisData.variableIndependiente; // Nuevo
            varDependienteEl.value = proyectoTesisData.variableDependiente;   // Nuevo


            configurarBtn.addEventListener('click', () => {
                let isValid = true;
                [nivelAcademicoEl, enfoqueEl, disenoEl, formulacionEl, objGeneralEl, objEspecificosEl, varIndependienteEl, varDependienteEl].forEach(el => el.classList.remove('input-error'));
                [errorNivel, errorEnfoque, errorDiseno, errorFormulacion, errorObjGeneral, errorObjEspecificos, errorVarInd, errorVarDep].forEach(el => el.classList.add('hidden'));
                mensajeConfirmacion.classList.add('hidden');

                if (!nivelAcademicoEl.value) { nivelAcademicoEl.classList.add('input-error'); errorNivel.classList.remove('hidden'); isValid = false; }
                if (!enfoqueEl.value) { enfoqueEl.classList.add('input-error'); errorEnfoque.classList.remove('hidden'); isValid = false; }
                if (!disenoEl.value.trim()) { disenoEl.classList.add('input-error'); errorDiseno.classList.remove('hidden'); isValid = false; }
                if (!varIndependienteEl.value.trim()) { varIndependienteEl.classList.add('input-error'); errorVarInd.classList.remove('hidden'); isValid = false; } // Nuevo
                if (!varDependienteEl.value.trim()) { varDependienteEl.classList.add('input-error'); errorVarDep.classList.remove('hidden'); isValid = false; }   // Nuevo
                if (!formulacionEl.value.trim()) { formulacionEl.classList.add('input-error'); errorFormulacion.classList.remove('hidden'); isValid = false; }
                if (!objGeneralEl.value.trim()) { objGeneralEl.classList.add('input-error'); errorObjGeneral.classList.remove('hidden'); isValid = false; }
                if (!objEspecificosEl.value.trim()) { objEspecificosEl.classList.add('input-error'); errorObjEspecificos.classList.remove('hidden'); isValid = false; }

                if(isValid){
                    proyectoTesisData.nivelAcademico = nivelAcademicoEl.value;
                    proyectoTesisData.enfoqueInvestigacion = enfoqueEl.value;
                    proyectoTesisData.disenoInvestigacion = disenoEl.value.trim();
                    proyectoTesisData.variableIndependiente = varIndependienteEl.value.trim(); // Nuevo
                    proyectoTesisData.variableDependiente = varDependienteEl.value.trim();   // Nuevo
                    proyectoTesisData.formulacionProblema = formulacionEl.value.trim();
                    proyectoTesisData.objetivoGeneral = objGeneralEl.value.trim();
                    proyectoTesisData.objetivosEspecificos = objEspecificosEl.value.trim();
                    
                    mensajeConfirmacion.classList.remove('hidden');
                }
            });
        }


        function init() {
            menuItems.forEach(item => {
                const menuItemElement = document.createElement('a');
                menuItemElement.href = '#';
                menuItemElement.id = `menu-${item.id}`;
                menuItemElement.className = 'sidebar-item flex items-center py-2.5 px-4 rounded-lg text-slate-300 hover:bg-slate-700 hover:text-white transition duration-150 ease-in-out';
                menuItemElement.innerHTML = `${item.icon} <span class="text-sm font-medium">${item.title}</span>`;
                
                menuItemElement.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (currentActiveItemId) {
                        document.getElementById(currentActiveItemId)?.classList.remove('active', 'bg-sky-600', 'text-white');
                        document.getElementById(currentActiveItemId)?.classList.add('text-slate-300', 'hover:bg-slate-700');
                    }
                    menuItemElement.classList.add('active', 'bg-sky-600', 'text-white');
                    menuItemElement.classList.remove('text-slate-300', 'hover:bg-slate-700');
                    currentActiveItemId = menuItemElement.id;

                    if (item.hasTabs) {
                        renderTabbedContent(item);
                    } else {
                        renderRegularContent(item);
                    }
                });
                menuNavElement.appendChild(menuItemElement);
            });

            if (!currentActiveItemId) { 
                welcomeMessageElement.style.display = 'block';
            }
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
